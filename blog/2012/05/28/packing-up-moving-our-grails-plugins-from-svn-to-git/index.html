
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Packing up: Moving Our Grails Plugins From SVN to Git - Lauri Piispanen</title>
  <meta name="author" content="Lauri Piispanen">

  
  <meta name="description" content="As part of the migration from SVN over to Git in our company, we also need to transport our internal Grails plugins to the new repo structure. These &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lauripiispanen.github.com/blog/2012/05/28/packing-up-moving-our-grails-plugins-from-svn-to-git">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Lauri Piispanen" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-151402-10']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Lauri Piispanen</a></h1>
  
    <h2>These are not the posts you are looking for.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:lauripiispanen.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Packing Up: Moving Our Grails Plugins From SVN to Git</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-28T16:35:00+03:00" pubdate data-updated="true">May 28<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>As part of the migration from SVN over to Git in our company, we also need to transport our internal Grails plugins to the new repo structure. These plugins have been developed since Grails 1.1.x, and as such, there&#8217;s a thing or two that have changed over the years - in terms of how grails plugins are stored in a repo and how the published artifacts are resolved.</p>

<!--more-->


<p>When our internal plugin development process started, we were still using Grails 1.1. Grails plugins were a wonderful way for us to encapsulate functionality, so that we didn&#8217;t have to reinvent the wheel with every new customer project.</p>

<p>Grails 1.1 relied heavily on SVN, whereas starting from 1.2 versions of Grails, migration towards <a href="http://ant.apache.org/ivy/">Apache Ivy</a> dependency resolution began to take place. Back then, the <em>right way</em> to publish plugins was to store them in an SVN repository as .zip files. While this feels &#8220;unclean&#8221; to how I see repos should be used, it was supported out of the box in Grails, and the process of using it was rather straightforward, so we stuck with it.</p>

<p>Fast-forward over to Grails 2.x, and the <em>correct</em> way to handle plugins is to set up an Ivy/Maven compliant repository and publish the .zip artefacts there. In fact, the old way of having the .zip artefacts in SVN is <a href="http://jira.grails.org/browse/GPRELEASE-36">no longer</a> supported at all.</p>

<p>So, to move over to Git, we would need to do two things:</p>

<ol>
<li>Use <em>git svn</em> to init the new repo and fetch the changes</li>
<li>Create an authors file to link committers across repositories</li>
<li>We need to get rid of the .zip files in our new git repo and move them to <a href="http://www.jfrog.com/products.php">Artifactory</a> instead</li>
</ol>


<p>To do this, we would use three commands:</p>

<pre><code>$ git svn init --no-minimize-url [SVN-repo]
</code></pre>

<p>The init command sets up a new git repo in an empty local dir, and <em>svn init</em> adds the appropriate remote refs to Git. Our SVN repo was laid out so that each plugin was in a subfolder in the repo root, and that subfolder followed the standard trunk/tags/branches layout, so I added <em>&#8211;no-minimize-url</em> flag to ensure that git svn considered the provided url the root of the repo, and would not attempt to navigate down towards the actual repo root.</p>

<pre><code>$ git svn fetch --authors-file=[authors-file]
</code></pre>

<p>Then I did an svn fetch for the remote refs, providing an authors file so that committers could be mapped correctly to Git. And authors file is a simple text file with each line corresponding to a different author:</p>

<pre><code>lpiispanen = Lauri Piispanen &lt;lauri.piispanen@my-email-address-is-gone.com&gt;
jdoe = John Doe &lt;john.doe@my-email-address-is-gone.com&gt;
</code></pre>

<p>Finally, I wanted to get rid of all the published artefacts in the SVN dirs, and <em>filter-branch</em> allowed me to do just that. An additional benefit of <em>filter-branch</em> is that it shrinks down the entire repo size - as if the artefacts had never been committed in the first place. You probably would not want to do this on an existing repo, since then the clones that people have already taken will face some nasty history conflicts - but as we&#8217;re working on a brand new Git repo, it&#8217;s fine:</p>

<pre><code>$ git filter-branch --index-filter 'git rm --cached --ignore-unmatch grails-*.zip' HEAD
</code></pre>

<p>That&#8217;s it! We now have a clean git repo, ready to be pushed to a different remote. Now, the next step is to push the .zip artefacts to Artefactory and we can archive the SVN repo entirely.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Lauri Piispanen</span></span>

      








  


<time datetime="2012-05-28T16:35:00+03:00" pubdate data-updated="true">May 28<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/git/'>Git</a>, <a class='category' href='/blog/categories/grails/'>Grails</a>, <a class='category' href='/blog/categories/svn/'>SVN</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://lauripiispanen.github.com/blog/2012/05/28/packing-up-moving-our-grails-plugins-from-svn-to-git/" data-via="lauripiispanen" data-counturl="http://lauripiispanen.github.com/blog/2012/05/28/packing-up-moving-our-grails-plugins-from-svn-to-git/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/05/09/responsive-websites-forget-about-the-media-queries/" title="Previous Post: Responsive websites: forget about the media queries">&laquo; Responsive websites: forget about the media queries</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/05/28/packing-up-moving-our-grails-plugins-from-svn-to-git/">Packing up: Moving Our Grails Plugins From SVN to Git</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/09/responsive-websites-forget-about-the-media-queries/">Responsive websites: forget about the media queries</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/04/25/what-is-the-best-irc-server-how-about-flowdock/">What is the best IRC Server? How about Flowdock?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/05/best-way-to-kill-html5-tablet-app-performance/">Best way to kill your HTML5 tablet app performance</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/23/groovy-primitive-type-cast-gotcha-when-upgrading-to-grails-2-dot-0/">Groovy primitive type cast gotcha when upgrading to Grails 2.0</a>
      </li>
    
  </ul>
</section>

<section>
  
  <iframe width="100%" height="450" scrolling="no" frameborder="no" src="http://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Fusers%2F2113937&amp;auto_play=false&amp;show_artwork=false&amp;color=ff7700"></iframe>
</section>


<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/lauripiispanen">@lauripiispanen</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'lauripiispanen',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("lauripiispanen", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/lauripiispanen" class="twitter-follow-button" data-show-count="false">Follow @lauripiispanen</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Lauri Piispanen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'lauripiispanen';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://lauripiispanen.github.com/blog/2012/05/28/packing-up-moving-our-grails-plugins-from-svn-to-git/';
        var disqus_url = 'http://lauripiispanen.github.com/blog/2012/05/28/packing-up-moving-our-grails-plugins-from-svn-to-git/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
