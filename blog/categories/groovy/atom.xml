<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Groovy | Lauri Piispanen]]></title>
  <link href="http://lauripiispanen.github.com/blog/categories/groovy/atom.xml" rel="self"/>
  <link href="http://lauripiispanen.github.com/"/>
  <updated>2012-05-09T01:32:17+03:00</updated>
  <id>http://lauripiispanen.github.com/</id>
  <author>
    <name><![CDATA[Lauri Piispanen]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Groovy primitive type cast gotcha when upgrading to Grails 2.0]]></title>
    <link href="http://lauripiispanen.github.com/blog/2012/02/23/groovy-primitive-type-cast-gotcha-when-upgrading-to-grails-2-dot-0/"/>
    <updated>2012-02-23T18:13:00+02:00</updated>
    <id>http://lauripiispanen.github.com/blog/2012/02/23/groovy-primitive-type-cast-gotcha-when-upgrading-to-grails-2-dot-0</id>
    <content type="html"><![CDATA[<p>When upgrading our Grails applications from 1.3.x to 2.0, I got burned by this slight change of semantics in Groovy 1.8.x:</p>

<p>Groovy 1.7.9:</p>

<p><code>java
groovy:000&gt; null as int
===&gt; null
</code></p>

<p>Groovy 1.8.0:</p>

<p><code>java
groovy:000&gt; null as float         
ERROR org.codehaus.groovy.runtime.typehandling.GroovyCastException:
Cannot cast object 'null' with class 'null' to class 'float'. Try 'java.lang.Float' instead
</code></p>

<p>Turns out this can bite you in quite many places. A very common pattern occurring in our taglibs was to cast attributes, even if they were optional. Like this:</p>

<p>``` java
def myTag = { attrs, body -></p>

<pre><code>def height = attrs.remove("height") as int
</code></pre>

<p>}
```</p>

<p>Which would've simply assigned <em>null</em> to <em>height</em> in Grails 1.3.x. Luckily you can just change your casts to boxed versions of the primitives (i.e. <em>as Integer</em>, <em>as Long</em> etc) and be done with it.</p>

<p>``` java
def myTag = { attrs, body -></p>

<pre><code>def height = attrs.remove("height") as Integer
</code></pre>

<p>}
```</p>
]]></content>
  </entry>
  
</feed>
